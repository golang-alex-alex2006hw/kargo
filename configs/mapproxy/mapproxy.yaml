# -------------------------------
# MapProxy example configuration.
# -------------------------------
#
# This is a minimal MapProxy configuration.
# See full_example.yaml and the documentation for more options.
#

# Starts the following services:
# Demo:
#     http://localhost:8080/demo
# WMS:
#     capabilities: http://localhost:8080/service?REQUEST=GetCapabilities
# WMTS:
#     capabilities: http://localhost:8080/wmts/1.0.0/WMTSCapabilities.xml
#     first tile: http://localhost:8080/wmts/osm/webmercator/0/0/0.png
# Tile service (compatible with OSM/etc.)
#     first tile: http://localhost:8080/tiles/osm/webmercator/0/0/0.png
# TMS:
#     note: TMS is not compatible with OSM/Google Maps/etc.
#     fist tile: http://localhost:8080/tms/1.0.0/osm/webmercator/0/0/0.png
# KML:
#     initial doc: http://localhost:8080/kml/osm/webmercator

services:
  demo:
  wms:
  tms:
  wmts:

layers:
  - name: omt_osm
    title: OpenStreetMap
    sources: [omt_osm_cache]

  - name: omt_osm-terrain
    title: OpenStreetMap & Terrain data
    sources: [omt_osm-terrain_cache]
     
  - name: ign_bdortho-5m
    title: IGN BDORTHO (5m)
    sources: [ign_bdortho-5m_cache]

  - name: esa_s2
    title: ESA S2
    sources: [esa_s2_cache]

caches:
  omt_osm_cache:
    grids: [GLOBAL_WEBMERCATOR]
    sources: [omt_osm_source]
    cache:
      type: s3
      bucket_name: kargo
      directory: cache/osm

  omt_osm-terrain_cache:
    grids: [GLOBAL_WEBMERCATOR]
    sources: [omt_osm-terrain_source]
    cache:
      type: s3
      bucket_name: kargo
      directory: cache/osm-terrain

  ign_bdortho-5m_cache:
    grids: [GLOBAL_WEBMERCATOR]
    sources: [ign_bdortho-5m_source]
    cache:
      type: s3
      bucket_name: kargo
      directory: cache/bdortho-5m

  esa_s2_cache:
    grids: [GLOBAL_WEBMERCATOR]
    sources: [esa_s2_source]
    format: image/jpeg
    cache:
      type: s3
      bucket_name: kargo
      directory: cache/s2

sources:
  omt_osm_source:
    type: tile
    grid: GLOBAL_WEBMERCATOR
    url: http://tileservergl/styles/osm-bright/%(z)s/%(x)s/%(y)s.png
 
  omt_osm-terrain_source:
    type: tile
    grid: GLOBAL_WEBMERCATOR
    url: http://tileservergl/styles/osm-terrain/%(z)s/%(x)s/%(y)s.png

  ign_bdortho-5m_source:
    type: tile
    grid: GLOBAL_WEBMERCATOR
    url: http://tileservergl/styles/bdortho-5m/%(z)s/%(x)s/%(y)s.png
    coverage:
      bbox: [-5,41,10,51]
      srs: 'EPSG:4326'  

  esa_s2_source:
    type: tile
    grid: GLOBAL_WEBMERCATOR
    url: https://tiles.maps.eox.at/wmts/1.0.0/s2cloudless_3857/default/g/%(z)s/%(y)s/%(x)s.jpg

